@import models.timetoteach.TimeToTeachUserId
@import duplicate.model.ClassId
@(handler: be.objectify.deadbolt.scala.DeadboltHandler, userPictureUri: Option[String], userFirstName: Option[String], userFamilyName: Option[String], tttUserId: TimeToTeachUserId, teacherSchoolToClasses: Map[String, List[duplicate.model.ClassDetails]], classIdToOverallProgress: Map[ClassId, Int])

@timetoteachAppMain(handler, s"Termly Plans",
    userPictureUri, userFirstName, userFamilyName) {

    <div class="in-app-menu-small-devices">
        <li class="nav-item nav-login-button">
            <a class="btn btn-outline-primary" role="button" href="@routes.Application.timeToTeachApp()">
                Dashboard</a>
        </li>

        <li class="nav-item nav-login-button">
            <a class="btn btn-outline-primary" role="button" href="@controllers.planning.classtimetable.routes.ClassTimetableController.classesHome()">
                Classes Home</a>
        </li>


    </div>
} {
    <div class="container">
        <div class="manage-class-form-section">
            <div class="in-app-menu-medium-and-up">
                <div class="d-flex ">
                    <ul class="nav mr-auto justify-content-between">
                        <li class="nav-item manage-class-nav-item-leftmost">
                            <a class="btn btn-primary" role="button" href="@routes.Application.timeToTeachApp()">
                                Dashboard</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="termly-plans-overview-of-all-classes-section">
            @for(schoolName_to_class <- teacherSchoolToClasses) {
                <div class="text-center termly-plans-overview-school-name"><h5>@schoolName_to_class._1</h5></div>
                <div class="in-app-menu-medium-and-up">
                    <div class="termly-plans-overview-headers">
                        <div class="row">
                            <div class="col-lg-2"><small class="text-muted">Class Name</small></div>
                            <div class="col-lg-2"><small class="text-muted">Termly Plan Progress</small></div>
                            <div class="col-lg-6"><small class="text-muted">Teachers</small></div>
                        </div>
                    </div>
                </div>

                @for(teacherClass <- schoolName_to_class._2) {
                    <div class="termly-plans-overview-row">
                        <div class="row">
                            <div class="col-xs-3 col-lg-2">
                                <a class="btn btn-sm btn-primary btn-block" role="button"
                                href="@controllers.planning.termly.routes.TermlyPlansController.termlyPlansForClass(teacherClass.id.id)">
                                @teacherClass.className.name</a>
                            </div>
                            <div class="col-xs-3 col-lg-2">
                                <div class="progress">
                                @{
                                    if(classIdToOverallProgress.isDefinedAt(teacherClass.id)) {
                                        defining(classIdToOverallProgress(teacherClass.id) + "%") { overallProgressPercent =>
                                            defining(s"width: $overallProgressPercent") { theWidth =>
                                                defining(if(overallProgressPercent == "100%") "progress-bar progress-bar-striped bg-success" else "progress-bar progress-bar-striped bg-warning") { progressBackground =>
                                                    <div class={progressBackground} role="progressbar"
                                                    style={theWidth} aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                                    <strong>{overallProgressPercent}</strong>
                                                    </div>
                                                }
                                            }
                                        }
                                    } else {
                                            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 0" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                    }
                                }
                                </div>
                            </div>
                            <div class="col-xs-0 col-lg-6 muted">@userFirstName @userFamilyName</div>
                            <div class="col-xs-3 col-lg-2">
                                <button class="btn btn-sm btn-danger btn-block" role="button" href="#" disabled="true">Download PDF</button>
                            </div>
                        </div>
                    </div>
                }
            }

            @if(teacherSchoolToClasses.isEmpty) {
                <div class="teacher-classes-deck">
                    <h5 class="noClassesMsg text-center">No classes created yet.</h5>
                </div>
            }
        </div>

    </div>
}
